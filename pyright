#!/bin/bash
# Claude Interceptor for 'pyright' command

# Check for bypass flags
if [[ "$CLAUDE_INTERCEPTOR_BYPASS" == "1" ]] || [[ "$*" == *"--force"* ]]; then
    # Try to find the real pyright executable
    if command -v pyright >/dev/null 2>&1; then
        REAL_PYRIGHT=$(which pyright)
        exec "$REAL_PYRIGHT" "$@"
    else
        echo "âŒ pyright not found in system PATH" >&2
        exit 127
    fi
    exit $?
fi

echo "âŒ pyright usage detected!"
echo ""
echo "ğŸ¤– AI Agent Instructions:"
echo "  For much faster type checking:"
echo "  âš¡ ty $*"
echo "  ğŸ“‹ uv tool run ty $*  # If ty not installed"
echo ""
echo "ğŸ’¡ Why ty is better:"
echo "  â€¢ 10-100x faster than pyright"
echo "  â€¢ Native Rust binary (no Node.js dependency)"
echo "  â€¢ Same type checking accuracy as pyright"
echo "  â€¢ Better error messages and performance"
echo "  â€¢ Easy to install and use"
echo ""
echo "ğŸ”§ Other fast alternatives:"
echo "  ğŸ“Š basedpyright $* # Faster pyright fork"
echo ""
echo "ğŸ”§ To proceed with pyright anyway:"
echo "  pyright --force $*"
echo "  CLAUDE_INTERCEPTOR_BYPASS=1 pyright $*"
echo ""
echo "ğŸ’¡ Learn more: https://github.com/whtcorpsinc/comypy"
echo "ğŸ”§ Disable globally: claude-interceptor disable"

exit 1