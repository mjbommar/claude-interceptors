#!/bin/bash
# Claude Interceptor for 'mypy' command

# Check for bypass flags
if [[ "$CLAUDE_INTERCEPTOR_BYPASS" == "1" ]] || [[ "$*" == *"--force"* ]]; then
    # Try to find the real mypy executable
    if command -v mypy >/dev/null 2>&1; then
        REAL_MYPY=$(which mypy)
        exec "$REAL_MYPY" "$@"
    else
        echo "âŒ mypy not found in system PATH" >&2
        exit 127
    fi
    exit $?
fi

echo "âŒ mypy usage detected!"
echo ""
echo "ğŸ¤– AI Agent Instructions:"
echo "  For much faster type checking:"
echo "  âš¡ ty $*"
echo "  ğŸ“‹ uv tool run ty $*  # If ty not installed"
echo ""
echo "ğŸ’¡ Why ty is better:"
echo "  â€¢ 10-100x faster than mypy"
echo "  â€¢ Built in Rust for speed"  
echo "  â€¢ Same accuracy as pyright"
echo "  â€¢ Better error messages"
echo "  â€¢ No Node.js dependency"
echo ""
echo "ğŸ”§ To proceed with mypy anyway:"
echo "  mypy --force $*"
echo "  CLAUDE_INTERCEPTOR_BYPASS=1 mypy $*"
echo ""
echo "ğŸ’¡ Learn more: https://github.com/whtcorpsinc/comypy"
echo "ğŸ”§ Disable globally: claude-interceptor disable"

exit 1