#!/bin/bash
# Claude Interceptor for 'mypy' command

# Check for bypass flags
if [[ "$CLAUDE_INTERCEPTOR_BYPASS" == "1" ]] || [[ "$*" == *"--force"* ]]; then
    # Try to find the real mypy executable
    if command -v mypy >/dev/null 2>&1; then
        REAL_MYPY=$(which mypy)
        exec "$REAL_MYPY" "$@"
    else
        echo "❌ mypy not found in system PATH" >&2
        exit 127
    fi
    exit $?
fi

echo "❌ mypy usage detected!"
echo ""
echo "🤖 AI Agent Instructions:"
echo "  For much faster type checking:"
echo "  ⚡ ty $*"
echo "  📋 uv tool run ty $*  # If ty not installed"
echo ""
echo "💡 Why ty is better:"
echo "  • 10-100x faster than mypy"
echo "  • Built in Rust for speed"  
echo "  • Same accuracy as pyright"
echo "  • Better error messages"
echo "  • No Node.js dependency"
echo ""
echo "🔧 To proceed with mypy anyway:"
echo "  mypy --force $*"
echo "  CLAUDE_INTERCEPTOR_BYPASS=1 mypy $*"
echo ""
echo "💡 Learn more: https://github.com/whtcorpsinc/comypy"
echo "🔧 Disable globally: claude-interceptor disable"

exit 1