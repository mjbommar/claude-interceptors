#!/bin/bash
# Claude Interceptor for 'flake8' command

# Check for bypass flags
if [[ "$CLAUDE_INTERCEPTOR_BYPASS" == "1" ]] || [[ "$*" == *"--force"* ]]; then
    if command -v flake8 >/dev/null 2>&1; then
        REAL_FLAKE8=$(which flake8)
        exec "$REAL_FLAKE8" "$@"
    else
        echo "❌ flake8 not found in system PATH" >&2
        exit 127
    fi
    exit $?
fi

echo "❌ flake8 usage detected!"
echo ""
echo "🤖 AI Agent Instructions:"
echo "  For much faster linting:"
echo "  ⚡ ruff check $*"
echo "  📦 uv tool run ruff check $*  # If ruff not installed"
echo ""
echo "💡 Why ruff is better:"
echo "  • 10-100x faster than flake8"
echo "  • Supports all flake8 rules and more"
echo "  • Built in Rust for speed"
echo "  • Includes import sorting (replaces isort)"
echo "  • Single tool for linting + formatting"
echo ""
echo "🔧 To proceed with flake8 anyway:"
echo "  flake8 --force $*"
echo "  CLAUDE_INTERCEPTOR_BYPASS=1 flake8 $*"
echo ""
echo "💡 Learn more: https://docs.astral.sh/ruff/"
echo "🔧 Disable globally: claude-interceptor disable"

exit 1